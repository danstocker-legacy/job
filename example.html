<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>jOB Sample Benchmark</title>
	<link rel="stylesheet" href="job.css" type="text/css" media="screen" />
	<script src="http://code.jquery.com/jquery-1.5.2.min.js"></script>
	<script src="job.js"></script>
	<script>
	/*global jQuery, jOB */
	(function ($, jOB) {
		// creating sparse and dense array
		var length = 1000,
				sparse = [],
				dense = [],
				strings = [],
				random = [],
				i, pos;
		for (i = 0; i < length; i++) {
			sparse[4 * i] = i;
			dense.push(i);
			strings.push(i.toString());
			random.splice(Math.random() * random.length, 0, i.toString());			
		}
		
		//////////////////////////////
		// LOOPS

		jOB.benchmark("Comparing for..in and for..i++ for dense and sparse arrays (both w/ 1000 elements). Dense arrays have few 'holes' in them, sparse arrays have lots.");
		
		jOB.test("for..i++ / dense array", function () {
			var result = [];
			for (i = 0; i < dense.length; i++) {
				result.push(dense[i]);
			}
			return result;
		}, function () {
			var result = [];
			for (i = 0; i < 2 * dense.length; i++) {
				result.push(dense[i]);
			}
			return result;
		}, {lengthonly: true});

		jOB.test("for..i++ / sparse array", function () {
			var result = [];
			for (i = 0; i < sparse.length; i++) {
				if (!sparse[i]) {
					continue;
				} else {
					result.push(sparse[i]);
				}
			}
			return result;
		}, {lengthonly: true});

		jOB.test("for..in / dense array", function () {
			var result = [];
			for (i in dense) {
				if (dense.hasOwnProperty(i)) {
					result.push(dense[i]);
				}
			}
			return result;
		}, {lengthonly: true});

		jOB.test("for..in / sparse array", function () {
			var result = [];
			for (i in sparse) {
				if (sparse.hasOwnProperty(i)) {
					result.push(sparse[i]);
				}
			}
			return result;
		}, {lengthonly: true});
		
		//////////////////////////////
		// ARRAY BUILDING

		jOB.benchmark("Adding " + length + " elements to array using...");
		
		jOB.test("Array.push()", function () {
			var result = [],
					i;
			for (i = 0; i < length; i++) {
				result.push({num: i});
			}
			return result;
		}, {lengthonly: true});
		
		jOB.test("Array.splice() at end", function () {
			var result = [],
					i;
			for (i = 0; i < length; i++) {
				result.splice(result.length, 0, {num: i});
			}
			return result;
		}, {lengthonly: true});
		
		jOB.test("Array.unshift()", function () {
			var result = [],
					i;
			for (i = 0; i < length; i++) {
				result.unshift({num: i});
			}
			return result;
		}, {lengthonly: true});

		jOB.test("Array.splice() at start", function () {
			var result = [],
					i;
			for (i = 0; i < length; i++) {
				result.splice(0, 0, {num: i});
			}
			return result;
		}, {lengthonly: true});

		jOB.test("Array.splice() at middle", function () {
			var result = [],
					i;
			for (i = 0; i < length; i++) {
				result.splice(Math.floor(result.length / 2), 0, {num: i});
			}
			return result;
		}, {lengthonly: true});
		
		//////////////////////////////
		// ARRAY DECONSTRUCTION

		jOB.benchmark("Removing " + length + " elements from array using...");
		
		jOB.test("Array.pop()", function () {
			var result = dense.concat([]),
					i;
			for (i = 0; i < length; i++) {
				result.pop();
			}
			return result;
		}, {lengthonly: true});
		
		jOB.test("Array.splice() at end", function () {
			var result = dense.concat([]),
					i;
			for (i = 0; i < length; i++) {
				result.splice(result.length - 1, 1);
			}
			return result;
		}, {lengthonly: true});
		
		jOB.test("Array.shift()", function () {
			var result = dense.concat([]),
					i;
			for (i = 0; i < length; i++) {
				result.shift();
			}
			return result;
		}, {lengthonly: true});
		
		jOB.test("Array.splice() at start", function () {
			var result = dense.concat([]),
					i;
			for (i = 0; i < length; i++) {
				result.splice(0, 1);
			}
			return result;
		}, {lengthonly: true});
		
		jOB.test("Array.splice() at middle", function () {
			var result = dense.concat([]),
					i;
			for (i = 0; i < length; i++) {
				result.splice(Math.floor(result.length / 2), 1);
			}
			return result;
		}, {lengthonly: true});

		//////////////////////////////
		// ARRAY DECONSTRUCTION

		jOB.benchmark("Sorting array of " + length + " elements");
		
		jOB.test("Randomized array of strings, native comparer", function () {
			var result = random.concat([]),
					i;
			result.sort();
			return result;
		}, {lengthonly: true});
		
		jOB.test("Already sorted array of strings, native comparer", function () {
			var result = strings.concat([]),
					i;
			result.sort();
			return result;
		}, {lengthonly: true});
		
		jOB.test("Randomized array W/ callback", function () {
			var result = random.concat([]),
					i;
			result.sort(function (a, b) {
				return a > b ? 1 : a < b ? -1 : 0;
			});
			return result;
		}, {lengthonly: true});
		
		jOB.test("Already sorted array W/ callback", function () {
			var result = strings.concat([]),
					i;
			result.sort(function (a, b) {
				return a > b ? 1 : a < b ? -1 : 0;
			});
			return result;
		}, {lengthonly: true});
	}(jQuery, jOB));
	</script>
</head>
<body>
	<h1>jOB Sample Benchmark</h1>
	<div id="job-toolbar"></div>
	<table id="job-benchmarks"></table>
	<table id="job-results"></table>
</body>
</html>
